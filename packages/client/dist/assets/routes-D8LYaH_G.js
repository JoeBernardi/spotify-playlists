import{A as e,F as t,L as n}from"./index-B27hr-OL.js";import{t as r}from"./compiler-runtime-DOHBwRV9.js";import{t as i}from"./Link-BGkOUOoA.js";var a=n(r()),o=n(t()),s=n(e()),c=e=>{let t=(0,a.c)(15),{track:n,setActiveTrack:r}=e,[i,c]=(0,o.useState)(1),l=(0,o.useRef)(null),u;t[0]===r?u=t[1]:(u=()=>{r(``)},t[0]=r,t[1]=u);let d=u,f;t[2]!==n||t[3]!==i?(f=()=>{if(!n)return;let e;c(1);let t=setTimeout(()=>{let t;t=i,e=setInterval(()=>{if(t-=.05,t<=0)return c(0),clearInterval(e);c(t),l.current&&(l.current.volume=t)},250)},25e3);return()=>{clearTimeout(t),clearInterval(e)}},t[2]=n,t[3]=i,t[4]=f):f=t[4];let p;t[5]===n?p=t[6]:(p=[n],t[5]=n,t[6]=p),(0,o.useEffect)(f,p);let m,h;t[7]===i?(m=t[8],h=t[9]):(m=()=>{l.current&&(l.current.volume=i)},h=[i],t[7]=i,t[8]=m,t[9]=h),(0,o.useEffect)(m,h);let g=n.preview_url??void 0,_;t[10]===d?_=t[11]:(_=()=>d(),t[10]=d,t[11]=_);let v;return t[12]!==g||t[13]!==_?(v=(0,s.jsx)(`div`,{className:`nav-player`,children:(0,s.jsx)(`audio`,{ref:l,src:g,autoPlay:!0,onEnded:_})}),t[12]=g,t[13]=_,t[14]=v):v=t[14],v},l=n(r()),u=e=>{let t=(0,l.c)(3),{text:n,href:r}=e,a;return t[0]!==r||t[1]!==n?(a=(0,s.jsx)(i,{className:`nav-item`,href:r,children:n}),t[0]=r,t[1]=n,t[2]=a):a=t[2],a},d=`data:image/svg+xml,%3csvg%20xmlns='http://www.w3.org/2000/svg'%20width='24'%20height='24'%20viewBox='0%200%2024%2024'%20fill='none'%20stroke='currentColor'%20stroke-width='2'%20stroke-linecap='round'%20stroke-linejoin='round'%20class='feather%20feather-plus'%3e%3cline%20x1='12'%20y1='5'%20x2='12'%20y2='19'%3e%3c/line%3e%3cline%20x1='5'%20y1='12'%20x2='19'%20y2='12'%3e%3c/line%3e%3c/svg%3e`,f=`data:image/svg+xml,%3csvg%20xmlns='http://www.w3.org/2000/svg'%20width='24'%20height='24'%20viewBox='0%200%2024%2024'%20fill='none'%20stroke='currentColor'%20stroke-width='2'%20stroke-linecap='round'%20stroke-linejoin='round'%20class='feather%20feather-minus'%3e%3cline%20x1='5'%20y1='12'%20x2='19'%20y2='12'%3e%3c/line%3e%3c/svg%3e`,p=n(r()),m=e=>{let t=(0,p.c)(21),{year:n,playlists:r,isActive:i,toggleYear:a}=e,o;t[0]===r?o=t[1]:(o=r.map(h),t[0]=r,t[1]=o);let c=o,l=`nav-playlists-year`,u;t[2]===Symbol.for(`react.memo_cache_sentinel`)?(u=(0,s.jsx)(d,{}),t[2]=u):u=t[2];let m=u;if(i){l=`nav-playlists-year active`;let e;t[3]===Symbol.for(`react.memo_cache_sentinel`)?(e=(0,s.jsx)(f,{}),t[3]=e):e=t[3],m=e}let g;t[4]!==a||t[5]!==n?(g=()=>a(n),t[4]=a,t[5]=n,t[6]=g):g=t[6];let _;t[7]===n?_=t[8]:(_=(0,s.jsx)(`h3`,{className:`nav-playlists-year-header-title`,children:n}),t[7]=n,t[8]=_);let v;t[9]===m?v=t[10]:(v=(0,s.jsx)(`div`,{className:`nav-playlists-year-header-icon`,children:m}),t[9]=m,t[10]=v);let y;t[11]!==g||t[12]!==_||t[13]!==v?(y=(0,s.jsxs)(`div`,{className:`nav-playlists-year-header`,onClick:g,children:[_,v]}),t[11]=g,t[12]=_,t[13]=v,t[14]=y):y=t[14];let b;t[15]===c?b=t[16]:(b=(0,s.jsx)(`div`,{className:`nav-playlists-year-playlists`,children:c}),t[15]=c,t[16]=b);let x;return t[17]!==y||t[18]!==b||t[19]!==l?(x=(0,s.jsxs)(`div`,{className:l,children:[y,b]}),t[17]=y,t[18]=b,t[19]=l,t[20]=x):x=t[20],x};function h(e){return(0,s.jsx)(u,{href:`/id/${e.id}`,text:e.month},e.id)}var g=n(r()),_=e=>{let t=(0,g.c)(26),{sortedPlaylistIds:n,playlistsById:r,activeTrackId:a,tracksById:l,setActiveTrack:u}=e,[d,f]=(0,o.useState)(``),p;t[0]===d?p=t[1]:(p=e=>f(e===d?``:e),t[0]=d,t[1]=p);let h=p,_;if(t[2]!==r||t[3]!==n){let e;t[5]===r?e=t[6]:(e=e=>r[e],t[5]=r,t[6]=e),_=n.map(e).reduce(v,{}),t[2]=r,t[3]=n,t[4]=_}else _=t[4];let y=_,b,x,S;if(t[7]!==d||t[8]!==y||t[9]!==h){let e=Object.keys(y).reverse();x=`sidebar`,t[13]===Symbol.for(`react.memo_cache_sentinel`)?(S=(0,s.jsx)(`header`,{children:(0,s.jsx)(i,{href:`/`,className:`hero`,children:`Likes Song`})}),t[13]=S):S=t[13],b=e.map(e=>(0,s.jsx)(m,{year:e,playlists:y[e],isActive:e===d,toggleYear:h})),t[7]=d,t[8]=y,t[9]=h,t[10]=b,t[11]=x,t[12]=S}else b=t[10],x=t[11],S=t[12];let C;t[14]!==a||t[15]!==u||t[16]!==l?(C=!!(l&&l[a])&&(0,s.jsx)(c,{track:l[a],setActiveTrack:u}),t[14]=a,t[15]=u,t[16]=l,t[17]=C):C=t[17];let w;t[18]===Symbol.for(`react.memo_cache_sentinel`)?(w=(0,s.jsx)(`section`,{className:`nav-meta`,children:(0,s.jsx)(i,{className:`nav-meta-title`,href:`/about`,children:`About`})}),t[18]=w):w=t[18];let T;t[19]!==b||t[20]!==C?(T=(0,s.jsxs)(`nav`,{children:[b,C,w]}),t[19]=b,t[20]=C,t[21]=T):T=t[21];let E;return t[22]!==x||t[23]!==S||t[24]!==T?(E=(0,s.jsxs)(`section`,{className:x,children:[S,T]}),t[22]=x,t[23]=S,t[24]=T,t[25]=E):E=t[25],E};function v(e,t){return e[t.year]?e[t.year].push(t):e[t.year]=[t],e}var y=`data:image/svg+xml,%3csvg%20xmlns='http://www.w3.org/2000/svg'%20width='24'%20height='24'%20viewBox='0%200%2024%2024'%20fill='none'%20stroke='currentColor'%20stroke-width='2'%20stroke-linecap='round'%20stroke-linejoin='round'%20class='feather%20feather-help-circle'%3e%3ccircle%20cx='12'%20cy='12'%20r='10'%3e%3c/circle%3e%3cpath%20d='M9.09%209a3%203%200%200%201%205.83%201c0%202-3%203-3%203'%3e%3c/path%3e%3cline%20x1='12'%20y1='17'%20x2='12.01'%20y2='17'%3e%3c/line%3e%3c/svg%3e`,b=`data:image/svg+xml,%3csvg%20xmlns='http://www.w3.org/2000/svg'%20width='24'%20height='24'%20viewBox='0%200%2024%2024'%20fill='none'%20stroke='currentColor'%20stroke-width='2'%20stroke-linecap='round'%20stroke-linejoin='round'%20class='feather%20feather-menu'%3e%3cline%20x1='3'%20y1='12'%20x2='21'%20y2='12'%3e%3c/line%3e%3cline%20x1='3'%20y1='6'%20x2='21'%20y2='6'%3e%3c/line%3e%3cline%20x1='3'%20y1='18'%20x2='21'%20y2='18'%3e%3c/line%3e%3c/svg%3e`,x=n(r()),S=()=>{let e=(0,x.c)(2),t;e[0]===Symbol.for(`react.memo_cache_sentinel`)?(t=(0,s.jsx)(i,{className:`mobile-footer-button nav-link`,href:`/about`,children:(0,s.jsx)(y,{})}),e[0]=t):t=e[0];let n;return e[1]===Symbol.for(`react.memo_cache_sentinel`)?(n=(0,s.jsxs)(`section`,{className:`mobile-footer`,children:[t,(0,s.jsx)(i,{className:`mobile-footer-button nav-link`,href:`/nav`,children:(0,s.jsx)(b,{})})]}),e[1]=n):n=e[1],n},C=n(r()),w=()=>{let e=(0,C.c)(1),t;return e[0]===Symbol.for(`react.memo_cache_sentinel`)?(t=(0,s.jsx)(`div`,{className:`loader-wrapper`,children:(0,s.jsxs)(`div`,{className:`loading-spinner`,children:[(0,s.jsx)(`div`,{}),(0,s.jsx)(`div`,{})]})}),e[0]=t):t=e[0],t},T=n(r()),E=e=>{let t=(0,T.c)(15),{getPlaylists:n,sortedPlaylistIds:r,playlistsById:i,activeTrackId:a,tracksById:c,setActiveTrack:l}=e,u;t[0]===n?u=t[1]:(u=()=>{n()},t[0]=n,t[1]=u);let d;t[2]===Symbol.for(`react.memo_cache_sentinel`)?(d=[],t[2]=d):d=t[2],(0,o.useEffect)(u,d);let f=!!r.length,p;t[3]!==a||t[4]!==f||t[5]!==i||t[6]!==l||t[7]!==r||t[8]!==c?(p=f&&(0,s.jsxs)(`section`,{className:`wrapper`,children:[(0,s.jsx)(_,{sortedPlaylistIds:r,playlistsById:i,activeTrackId:a,tracksById:c,setActiveTrack:l}),(0,s.jsx)(S,{})]}),t[3]=a,t[4]=f,t[5]=i,t[6]=l,t[7]=r,t[8]=c,t[9]=p):p=t[9];let m;t[10]===f?m=t[11]:(m=!f&&(0,s.jsx)(w,{}),t[10]=f,t[11]=m);let h;return t[12]!==p||t[13]!==m?(h=(0,s.jsxs)(`div`,{children:[p,m]}),t[12]=p,t[13]=m,t[14]=h):h=t[14],h},D=()=>{let[e,t]=(0,o.useState)([]),[n,r]=(0,o.useState)([]),[i,a]=(0,o.useState)(``),[c,l]=(0,o.useState)(!0),u=async()=>{try{l(!0);let e=await(await fetch(`/playlists`)).json();t(e);let n=e.flatMap(e=>e.tracks||[]);r(n)}catch(e){console.error(`Failed to fetch playlists:`,e)}finally{l(!1)}};(0,o.useEffect)(()=>{u()},[]);let d=e.map(e=>e.id),f=e.reduce((e,t)=>(e[t.id]=t,e),{}),p=n.reduce((e,t)=>(e[t.id]=t,e),{});return c?(0,s.jsx)(`div`,{children:`Loading...`}):(0,s.jsx)(E,{getPlaylists:u,setActiveTrack:a,activeTrackId:i,totalTrackLength:n.length,sortedPlaylistIds:d,allTracks:n,playlistsById:f,tracksById:p})};export{D as component};